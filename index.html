<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manisa Hava Durumu & Telsiz Röleleri</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{margin:0;font-family:Arial;background:#eef2f6;color:#111}
header{background:#0b4f8a;color:#fff;padding:15px;text-align:center;font-size:22px;font-weight:bold}
section{padding:15px}
h2{color:#0b4f8a}
table{width:100%;border-collapse:collapse;margin-bottom:20px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:#f2f2f2}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.card{border:1px solid #ddd;border-radius:6px;padding:10px;background:#fff}
footer{text-align:center;padding:10px;background:#0b4f8a;color:#fff}
#map{height:400px;width:100%;margin-bottom:20px}
.badge{padding:4px 7px;border-radius:6px;font-size:11px}
.active{background:#16a34a;color:#fff}
.passive{background:#ef4444;color:#fff}
.weather{font-size:14px;margin-top:5px}
</style>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const apiKey = "5d6b25435d433a575d97274fc936276f";

// İlçeler ve koordinatları
const districts = [
  {name:"Ahmetli", lat:38.381, lng:27.774},
  {name:"Akhisar", lat:38.918, lng:27.839},
  {name:"Alaşehir", lat:38.446, lng:27.849},
  {name:"Demirci", lat:38.918, lng:28.219},
  {name:"Gölmarmara", lat:38.515, lng:27.806},
  {name:"Gördes", lat:38.618, lng:27.923},
  {name:"Kırkağaç", lat:38.745, lng:27.641},
  {name:"Köprübaşı", lat:38.683, lng:28.375},
  {name:"Kula", lat:38.703, lng:28.362},
  {name:"Salihli", lat:38.464, lng:27.449},
  {name:"Sarıgöl", lat:38.304, lng:28.141},
  {name:"Saruhanlı", lat:38.557, lng:27.536},
  {name:"Selendi", lat:38.486, lng:28.086},
  {name:"Soma", lat:38.298, lng:27.319},
  {name:"Şehzadeler", lat:38.614, lng:27.429},
  {name:"Turgutlu", lat:38.512, lng:27.203},
  {name:"Yunusemre", lat:38.619, lng:27.425}
];

// Röleler ve koordinatları
const roles = [
  {name:"Spil Dağı VHF", lat:38.623, lng:27.433, status:"active"},
  {name:"Spil Dağı UHF", lat:38.623, lng:27.433, status:"active"},
  {name:"Soma Sivri Tepe UHF", lat:38.298, lng:27.319, status:"active"},
  {name:"Salihli Durasıllı UHF", lat:38.464, lng:27.449, status:"active"},
  {name:"Alaşehir Paşa UHF", lat:38.446, lng:27.849, status:"active"},
  {name:"Alaşehir CB Bant (27.035–27.275 MHz)", lat:38.446, lng:27.849, status:"active"},
  {name:"Kula Merkez UHF", lat:38.703, lng:28.362, status:"active"},
  {name:"Turgutlu Merkez UHF", lat:38.512, lng:27.203, status:"active"},
  {name:"Akhisar Merkez UHF", lat:38.918, lng:27.839, status:"active"},
  {name:"Demirci Merkez UHF", lat:38.918, lng:28.219, status:"active"},
  {name:"Kırkağaç Merkez UHF", lat:38.745, lng:27.641, status:"active"},
  {name:"Sarıgöl Merkez UHF", lat:38.304, lng:28.141, status:"active"},
  {name:"Gördes Merkez UHF", lat:38.618, lng:27.923, status:"active"},
  {name:"Şehzadeler Merkez UHF", lat:38.614, lng:27.429, status:"active"},
  {name:"Yunusemre Merkez UHF", lat:38.619, lng:27.425, status:"active"},
  {name:"Selendi Merkez UHF", lat:38.486, lng:28.086, status:"active"},
  {name:"Gölmarmara Merkez UHF", lat:38.515, lng:27.806, status:"active"},
  {name:"Ahmetli Merkez UHF", lat:38.381, lng:27.774, status:"active"},
  {name:"Saruhanlı Merkez UHF", lat:38.557, lng:27.536, status:"active"}
];

async function fetchWeather(city){
  try{
    const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city},TR&units=metric&lang=tr&appid=${apiKey}`);
    const data = await res.json();
    return data;
  } catch(e){
    return null;
  }
}

window.onload = async function(){
  // Harita
  var map = L.map('map').setView([38.619, 27.428], 9);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'&copy; OpenStreetMap contributors' }).addTo(map);

  // Röleler haritada
  roles.forEach(r=>{
    L.marker([r.lat,r.lng]).addTo(map)
      .bindPopup(`<b>${r.name}</b><br>Status: <span class='badge ${r.status}'>${r.status}</span>`);
  });

  // İlçeler hava durumu
  for(const d of districts){
    const weather = await fetchWeather(d.name);
    let desc="—", temp="—", wind="—";
    if(weather){
      temp = weather.main.temp + "°C";
      desc = weather.weather[0].description;
      wind = weather.wind.deg + "° " + weather.wind.speed + " m/s";
    }
    const card = document.createElement("div");
    card.className="card";
    card.innerHTML=`<b>${d.name}</b><div class="weather">Sıcaklık: ${temp}<br>Hava: ${desc}<br>Rüzgar: ${wind}</div>`;
    document.getElementById("districts").appendChild(card);
  }
};
</script>

</head>
<body>
<header>Manisa Hava Durumu & Aktif Telsiz Röleleri</header>

<section>
<h2>İlçeler & Hava Durumu</h2>
<div class="grid" id="districts">
<!-- JavaScript ile doldurulacak -->
</div>
</section>

<section>
<h2>Aktif Telsiz Röleleri</h2>
<table>
<tr><th>Yer</th><th>Bant</th><th>RX</th><th>TX</th><th>CTCSS</th></tr>
<tr><td>Spil Dağı</td><td>VHF</td><td>145.600</td><td>145.000</td><td>77.0</td></tr>
<tr><td>Spil Dağı</td><td>UHF</td><td>439.225</td><td>431.625</td><td>88.5</td></tr>
<tr><td>Soma Sivri Tepe</td><td>UHF</td><td>439.4125</td><td>431.8125</td><td>67.0</td></tr>
<tr><td>Salihli Durasıllı</td><td>UHF</td><td>439.425</td><td>431.825</td><td>88.5</td></tr>
<tr><td>Alaşehir Paşa</td><td>UHF</td><td>439.250</td><td>431.650</td><td>88.5</td></tr>
<tr><td>Alaşehir CB Bant</td><td>CB</td><td>27.035 – 27.275</td><td>—</td><td>—</td></tr>
<tr><td>Kula Merkez</td><td>UHF</td><td>439.350</td><td>431.750</td><td>88.5</td></tr>
<tr><td>Turgutlu Merkez</td><td>UHF</td><td>439.300</td><td>431.700</td><td>88.5</td></tr>
<tr><td>Akhisar Merkez</td><td>UHF</td><td>439.375</td><td>431.775</td><td>88.5</td></tr>
<tr><td>Demirci Merkez</td><td>UHF</td><td>439.360</td><td>431.760</td><td>88.5</td></tr>
<tr><td>Kırkağaç Merkez</td><td>UHF</td><td>439.365</td><td>431.765</td><td>88.5</td></tr>
<tr><td>Sarıgöl Merkez</td><td>UHF</td><td>439.370</td><td>431.770</td><td>88.5</td></tr>
<tr><td>Gördes Merkez</td><td>UHF</td><td>439.355</td><td>431.755</td><td>88.5</td></tr>
<tr><td>Şehzadeler Merkez</td><td>UHF</td><td>439.380</td><td>431.780</td><td>88.5</td></tr>
<tr><td>Yunusemre Merkez</td><td>UHF</td><td>439.385</td><td>431.785</td><td>88.5</td></tr>
<tr><td>Selendi Merkez</td><td>UHF</td><td>439.390</td><td>431.790</td><td>88.5</td></tr>
<tr><td>Gölmarmara Merkez</td><td>UHF</td><td>439.395</td><td>431.795</td><td>88.5</td></tr>
<tr><td>Ahmetli Merkez</td><td>UHF</td><td>439.400</td><td>431.800</td><td>88.5</td></tr>
<tr><td>Saruhanlı Merkez</td><td>UHF</td><td>439.405</td><td>431.805</td><td>88.5</td></tr>
</table>

<section>
<h2>Harita Üzerinde Röleler</h2>
<div id="map"></div>
</section>

<footer>© 2025 Manisa Hava & Röle Bilgi Sistemi</footer>
</body>
</html>
